<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="免费在线 PDF 分割工具，支持按页数、页面范围分割，客户端处理保护隐私">
    <meta name="keywords" content="PDF分割,PDF拆分,在线工具,客户端处理">
    <title>PDFSplit - 免费在线 PDF 分割工具</title>
    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="src/assets/favicon.svg">
    <link rel="alternate icon" href="src/assets/favicon.ico">
    
    <!-- Styles -->
    <link rel="stylesheet" href="src/css/main.css">
    
    <!-- Preload critical resources -->
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/pdf-lib@1.17.1/dist/pdf-lib.min.js" as="script">
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/pdfjs-dist@4.0.379/build/pdf.min.js" as="script">
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <svg class="logo-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                        <polyline points="14,2 14,8 20,8"/>
                        <line x1="16" y1="13" x2="8" y2="13"/>
                        <line x1="16" y1="17" x2="8" y2="17"/>
                        <polyline points="10,9 9,9 8,9"/>
                    </svg>
                    <h1>PDFSplit</h1>
                </div>
                <p class="tagline">免费在线 PDF 分割工具</p>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main">
        <div class="container">
            <!-- Upload Section -->
            <section class="upload-section" id="uploadSection">
                <div class="upload-area" id="uploadArea">
                    <div class="upload-icon">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                            <polyline points="7,10 12,15 17,10"/>
                            <line x1="12" y1="15" x2="12" y2="3"/>
                        </svg>
                    </div>
                    <div class="upload-content">
                        <h2>上传 PDF 文件</h2>
                        <p>拖拽文件到此处或点击选择文件</p>
                        <p class="upload-note">支持最大 50MB 的 PDF 文件，客户端处理保护隐私</p>
                    </div>
                    <input type="file" id="fileInput" accept=".pdf" hidden>
                </div>

                <!-- Progress Bar -->
                <div class="progress-container" id="progressContainer" style="display: none;">
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill"></div>
                    </div>
                    <div class="progress-text" id="progressText">处理中...</div>
                </div>

                <!-- Error Message -->
                <div class="error-message" id="errorMessage" style="display: none;"></div>
            </section>

            <!-- PDF Preview Section -->
            <section class="preview-section" id="previewSection" style="display: none;">
                <div class="preview-header">
                    <h2>PDF 预览</h2>
                    <div class="file-info" id="fileInfo"></div>
                </div>

                <div class="preview-content">
                    <!-- Split Options -->
                    <div class="split-options">
                        <h3>分割选项</h3>
                        <div class="option-group">
                            <div class="radio-option">
                                <input type="radio" id="splitByPages" name="splitMode" value="pages" checked>
                                <label for="splitByPages">按页数分割</label>
                                <div class="option-details" id="splitByPagesDetails">
                                    <input type="number" id="pagesPerFile" min="1" value="1" placeholder="每个文件页数">
                                </div>
                            </div>
                            
                            <div class="radio-option">
                                <input type="radio" id="splitByRange" name="splitMode" value="range">
                                <label for="splitByRange">按页面范围分割</label>
                                <div class="option-details" id="splitByRangeDetails" style="display: none;">
                                    <input type="text" id="pageRanges" placeholder="例如: 1-3, 5-10, 12">
                                </div>
                            </div>
                            
                            <div class="radio-option">
                                <input type="radio" id="extractPages" name="splitMode" value="extract">
                                <label for="extractPages">提取特定页面</label>
                                <div class="option-details" id="extractPagesDetails" style="display: none;">
                                    <input type="text" id="specificPages" placeholder="例如: 1, 3, 5, 8">
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- PDF Thumbnails -->
                    <div class="thumbnails-container">
                        <h3>页面预览</h3>
                        <div class="thumbnails-grid" id="thumbnailsGrid">
                            <!-- Thumbnails will be generated here -->
                        </div>
                    </div>
                </div>

                <!-- Action Buttons -->
                <div class="action-buttons">
                    <button class="btn btn-secondary" id="resetBtn">重新上传</button>
                    <button class="btn btn-primary" id="splitBtn">开始分割</button>
                </div>
            </section>

            <!-- Results Section -->
            <section class="results-section" id="resultsSection" style="display: none;">
                <div class="results-header">
                    <h2>分割完成</h2>
                    <p>您的 PDF 已成功分割为以下文件：</p>
                </div>
                
                <div class="download-list" id="downloadList">
                    <!-- Download links will be generated here -->
                </div>

                <div class="action-buttons">
                    <button class="btn btn-secondary" id="newFileBtn">处理新文件</button>
                    <button class="btn btn-primary" id="downloadAllBtn">下载全部</button>
                </div>
            </section>
        </div>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <p>&copy; 2024 PDFSplit. 所有文件在本地处理，保护您的隐私安全。</p>
        </div>
    </footer>

    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay" style="display: none;">
        <div class="loading-spinner"></div>
        <p>正在处理 PDF...</p>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/pdf-lib@1.17.1/dist/pdf-lib.min.js"></script>
    
    <!-- PDF.js 加载 -->
    <script src="https://cdn.jsdelivr.net/npm/pdfjs-dist@4.0.379/build/pdf.min.js"></script>
    
    <script>
        // 全局标志，标记PDF.js是否加载成功
        window.pdfJsAvailable = false;
        
        // 立即检查PDF.js是否加载
        if (typeof pdfjsLib !== 'undefined') {
            try {
                // Set up PDF.js worker and configuration
                pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdn.jsdelivr.net/npm/pdfjs-dist@4.0.379/build/pdf.worker.min.js';
                
                // Configure PDF.js
                pdfjsLib.GlobalWorkerOptions.cMapUrl = 'https://cdn.jsdelivr.net/npm/pdfjs-dist@4.0.379/cmaps/';
                pdfjsLib.GlobalWorkerOptions.cMapPacked = true;
                pdfjsLib.GlobalWorkerOptions.standardFontDataUrl = 'https://cdn.jsdelivr.net/npm/pdfjs-dist@4.0.379/standard_fonts/';
                
                window.pdfJsAvailable = true;
                console.log('PDF.js initialized successfully');
            } catch (error) {
                console.error('PDF.js initialization error:', error);
                window.pdfJsAvailable = false;
            }
        } else {
            console.warn('PDF.js not available, will use simplified version');
            window.pdfJsAvailable = false;
        }
    </script>
    
    <!-- 直接加载主脚本 -->
    <script src="src/js/main.js" type="module"></script>
</body>
</html>